## 业务特点
- 库存量少
- 业务简单
- 瞬时并发量大

## 架构设计
- 限流
    由于活动库存量一般都是很少，对应的只有少部分用户才能秒杀成功。所以我们需要限制大部分用户流量，只准少量用户流量进入后端服务器

- 削峰
    秒杀开始的那一瞬间，会有大量用户冲击进来，所以在开始时候会有一个瞬间流量峰值。如何把瞬间的流量峰值变得更平缓，是能否成功设计好秒杀系统的关键因素。实现流量削峰填谷，一般的采用缓存和 MQ 中间件来解决

- 异步
    秒杀其实可以当做高并发系统来处理，在这个时候，可以考虑从业务上做兼容，将同步的业务，设计成异步处理的任务，提高网站的整体可用性
    
- 缓存
    秒杀系统的瓶颈主要体现在下订单、扣减库存流程中。在这些流程中主要用到 OLTP 的数据库，类似 MySQL、SQLServer、Oracle。由于数据库底层采用 B+ 树的储存结构，对应我们随机写入与读取的效率，相对较低。如果我们把部分业务逻辑迁移到内存的缓存或者 Redis 中，会极大的提高并发效率
    
    
##  常见秒杀问题
1.什么时候把库存写入到Redis？
- 秒杀活动创建/维护时写入Redis。

2.如何保证活动数据库和库存数据一致？
- 可以使用分布式事务或消息队列。

3.下单减库存/支付减库存？
- 下单锁定库存，支付减库存。

4.如何防止商品被超卖？
- 把库存数据放入到缓存中，利用缓存的原子特性保证同时只有一个线程操作库存。

5.库存写回数据库的时机？
- 采用定时任务同步Redis的数据写回数据库。




